(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{383:function(t,s,a){"use strict";a.r(s);var r=a(25),e=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"安装-jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-jenkins"}},[t._v("#")]),t._v(" 安装 Jenkins")]),t._v(" "),a("p",[t._v("网上很多教程，自己搜。")]),t._v(" "),a("h2",{attrs:{id:"安装插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装插件"}},[t._v("#")]),t._v(" 安装插件")]),t._v(" "),a("h3",{attrs:{id:"安装配置-nodejs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装配置-nodejs"}},[t._v("#")]),t._v(" 安装配置 Nodejs")]),t._v(" "),a("p",[t._v("找到全局工具配置")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zhhbinn/picHome/master/20210204141314.png",alt:""}})]),t._v(" "),a("p",[t._v("选择版本，建议选择 LTS 版本")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zhhbinn/picHome/master/20210204141337.png",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"安装配置-publish-over-ssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装配置-publish-over-ssh"}},[t._v("#")]),t._v(" 安装配置 Publish Over SSH")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zhhbinn/picHome/master/20210204141405.png",alt:""}})]),t._v(" "),a("p",[t._v("勾上使用密码。下面有个测试连接按钮。")]),t._v(" "),a("p",[t._v("注意：实际上，这里显示成功后，构建也会提示连接服务器失败，因此需要在项目的构建后配置重新配置服务器的相关账号密码。")]),t._v(" "),a("h3",{attrs:{id:"安装配置-github-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装配置-github-api"}},[t._v("#")]),t._v(" 安装配置 Github API")]),t._v(" "),a("p",[t._v("安装后到 Github 生成 token。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zhhbinn/picHome/master/20210204141441.png",alt:""}})]),t._v(" "),a("p",[t._v("然后把生成的 token 复制到 secret 处")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zhhbinn/picHome/master/20210204141455.png",alt:""}})]),t._v(" "),a("p",[t._v("填写后，勾上管理 HOOK，然后点击右边的连接测试，成功的话会显示 github 的用户名")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zhhbinn/picHome/master/20210204141455.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"配置仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置仓库"}},[t._v("#")]),t._v(" 配置仓库")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zhhbinn/picHome/master/20210204141523.png",alt:""}})]),t._v(" "),a("p",[t._v("仓库如果为私有，需要配置账号。注意分支名字。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zhhbinn/picHome/master/20210204141538.png",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zhhbinn/picHome/master/20210204141714.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"配置脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置脚本"}},[t._v("#")]),t._v(" 配置脚本")]),t._v(" "),a("p",[t._v("构建前：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("node -v\nnpm -v\npwd\nrm -rf node_modules\ntar -zcf ../release.tgz .\n")])])]),a("p",[t._v("构建后：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd /projects/zhhbinn\ntar -xzf /var/lib/jenkins/workspace/release.tgz -C /projects/zhhbinn/egg20\ncd /projects/zhhbinn/egg20\nnpm install --production\nnpm run stop\nnpm run start\n")])])]),a("p",[t._v("过程：下载 git 最新代码——打包——转移路径——解压——安装/更新依赖——停止——启动")]),t._v(" "),a("h2",{attrs:{id:"遇到的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#遇到的问题"}},[t._v("#")]),t._v(" 遇到的问题")]),t._v(" "),a("h3",{attrs:{id:"构建时连接不上服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建时连接不上服务器"}},[t._v("#")]),t._v(" 构建时连接不上服务器")]),t._v(" "),a("p",[t._v("需要在构建后配置重新配置服务器的相关账号密码。原因不明。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zhhbinn/picHome/master/20210204141738.png",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"构建成功后内容没变"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建成功后内容没变"}},[t._v("#")]),t._v(" 构建成功后内容没变")]),t._v(" "),a("p",[t._v("注意工作路径，这里的路径位于 Jenkins 的工作区：/var/lib/jenkins/workspace。构建实际上是在 Jenkins 的工作区路径完成的。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/zhhbinn/picHome/master/20210204141911.png",alt:""}})])])}),[],!1,null,null,null);s.default=e.exports}}]);